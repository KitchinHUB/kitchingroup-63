
#+latex_header: \usepackage[normalem]{ulem}
#+latex_header: \usepackage{todonotes}
#+latex_header: \usepackage[usenames, dvipsnames]{color}

#+latex_header: \newcommand\cmred{\bgroup\markoverwith{\textcolor{red}{\rule[0.5ex]{4pt}{1.4pt}}}\ULon}
#+latex_header: \newcommand\cmblue{\bgroup\markoverwith{\textcolor{blue}{\rule[-0.5ex]{4pt}{1.4pt}}}\ULon}

#+LATEX_CLASS: no-article
#+LATEX_CLASS_OPTIONS: [12pt]
#+TITLE: Neural Network and ReaxFF comparison for Au properties

#+latex_header: \setlength{\oddsidemargin}{0in}
#+latex_header: \setlength{\textwidth}{6.5in}
#+latex_header: \setlength{\topmargin}{-0.5in}
#+latex_header: \setlength{\textheight}{9in}

#+latex_header: \usepackage{amssymb}
#+latex_header: \usepackage{amsmath}
#+latex_header: \usepackage{textcomp}
#+latex_header: \usepackage{underscore}
#+latex_header: \usepackage{graphicx}
#+latex_header: \usepackage{caption}
#+latex_header: \usepackage{color}
#+latex_header: \usepackage{dcolumn}
#+latex_header: \usepackage{bm}
#+latex_header: \usepackage{authblk}
#+latex_header: \usepackage[numbers,super,comma,sort&compress]{natbib}
#+latex_header: \usepackage{natmove}
#+latex_header: \usepackage[linktocpage,pdfstartview=FitH,colorlinks,
#+latex_header: linkcolor=blue,anchorcolor=blue,
#+latex_header: citecolor=blue,filecolor=blue,menucolor=blue,urlcolor=blue]{hyperref}
#+latex_header: \usepackage{float}
#+EXPORT_EXCLUDE_TAGS: noexport
#+OPTIONS: author:nil date:nil ^:{} toc:nil

#+latex_header: \author[1]{Jacob R. Boes}
#+latex_header: \author[2]{Mitchell C. Groenenboom}
#+latex_header: \author[2]{John A. Keith\thanks{jakeith@pitt.edu}}
#+latex_header: \author[1]{John R. Kitchin\thanks{jkitchin@andrew.cmu.edu}}
#+latex_header: \affil[1]{Department of Chemical Engineering, Carnegie Mellon University, 5000 Forbes Ave, Pittsburgh, PA 15213, USA}
#+latex_header: \affil[2]{Department of Chemical and Petroleum Engineering, University of Pittsburgh, Benedum Hall, 3700 O'Hara Street, Pittsburgh, PA 15261, USA}

\maketitle

#+begin_abstract
We have @@latex:\protect\cmred{developed}@@ @@latex:\protect\cmblue{studied how}@@ ReaxFF and Behler-Parrinello neural network @@latex:\protect\cmred{potentials that capably predict energetics of Au materials in diverse configurations. A set of 9972 Kohn-Sham density functional theory calculations were generated to train these potentials with the objective of understanding how}@@ @@latex:\protect\cmblue{atomistic}@@ potentials should be trained to be accurate and tractable across multiple structural @@latex:\protect\cmred{regimes.}@@ @@latex:\protect\cmblue{regimes of Au as a representative example of a single component material.}@@ We @@latex:\protect\cmred{found that the}@@ trained @@latex:\protect\cmblue{these potentials using subsets of 9,972 Kohn-Sham density functional theory calculations and then validated their predictions against the untrained data. Our best}@@ ReaxFF potential @@latex:\protect\cmred{can}@@ @@latex:\protect\cmblue{was trained from 848 data points and could}@@ reliably predict surface and bulk @@latex:\protect\cmred{data using an optimal training set of 848 calculations,}@@ @@latex:\protect\cmblue{data,}@@ but it @@latex:\protect\cmred{remains challenging to design a transferable ReaxFF potential that is also reliable}@@ @@latex:\protect\cmblue{was substantially less accurate}@@ for @@latex:\protect\cmblue{molecular}@@ clusters of 126 atoms or fewer. @@latex:\protect\cmblue{Training the ReaxFF potential to more data also resulted in overfitting and lower accuracy.}@@ In contrast, Behler-Parrinello neural networks @@latex:\protect\cmred{can}@@ @@latex:\protect\cmblue{could}@@ be fit to @@latex:\protect\cmred{much larger datasets (9734 calculations)}@@ @@latex:\protect\cmblue{9,734 calculations,}@@ and @@latex:\protect\cmred{they perform}@@ @@latex:\protect\cmblue{this potential performed}@@ comparably or better than ReaxFF across all regimes. However, the Behler-Parrinello neural network potential @@latex:\protect\cmred{does so with}@@ @@latex:\protect\cmblue{in this implementation brings}@@ significantly higher computational @@latex:\protect\cmred{cost in the implementation used in this work.}@@ @@latex:\protect\cmblue{cost.}@@
#+end_abstract

*Keywords:* Kohn-Sham density functional theory, neural networks, reactive force fields, potential energy surfaces, machine learning

#+BEGIN_LaTeX
\makeatletter
\renewcommand\@biblabel[1]{#1.}
\makeatother

\bibliographystyle{apsrev}

\renewcommand{\baselinestretch}{1.5}
\normalsize
#+END_LaTeX

* Introduction
Growing interest in nanoscale phenomena has driven the need for accurate computational models to study chemical properties at an atomistic level. Advances in high performance computing now enable powerful simulation tools such as Born-Oppenheimer molecular dynamics (BO-MD) and extended Monte Carlo techniques that employ first principles quantum chemistry (QC) methods (e.g. Kohn-Sham density functional theory (KS-DFT)) on increasingly complex reactions. However, many @@latex:\protect\cmred{bona fide}@@ @@latex:\protect\cmblue{genuine}@@ nanoscale systems of interest are @@latex:\protect\cmblue{currently}@@ too large to be studied with first principles @@LATEX:\PROTECT\CMRED{QC,}@@ @@latex:\protect\cmblue{QC and}@@ thus @@latex:\protect\cmred{requiring}@@ @@latex:\protect\cmblue{require}@@ the use of computationally efficient atomistic potentials.

Atomistic potentials approximate the potential energy surfaces (PES) for atomic systems by mapping potential energies and forces as functions of atomic positions. @@latex:\protect\cmred{One category of atomistic}@@ @@latex:\protect\cmblue{Physical}@@ potentials are @@latex:\protect\cmred{known as physical potentials, and they are}@@ parameterized to fit analytical expressions for the known physics of pairwise and many body interactions, @@latex:\protect\cmred{e.g.}@@ @@latex:\protect\cmblue{e.g.:}@@ Lennard-Jones potentials, cite:jones-1924-deter-molec-field classical force fields, cite:brooks-1983-charm,rappe-1992-uff,casewit-1992-applic,cornell-1995-secon-gener,cornell-1996-secon-gener the modified and standard embedded atom methods (MEAM and EAM) cite:daw-1983-semiem-quant,baskes-1992-modif, reactive force fields (ReaxFF) cite:duin-2001-reaxf, and charge-optimized many-body (COMB) potentials cite:liang-2012-variab-charg. Another intriguing category are @@latex:\protect\cmblue{mathematical}@@ potentials that ``learn'' the PES directly through a minimization of residuals with no /a priori/ knowledge of the underlying physics, e.g. Gaussian regression functions cite:rasmussen-2004-gauss-proces and artificial neural networks (NN) cite:haykin-2009-neural-networ. We refer to these as mathematical potentials.

Physical potentials have been @@latex:\protect\cmred{widely}@@ used for decades @@latex:\protect\cmred{given their ability}@@ to capture the underlying physics of complex @@latex:\protect\cmred{systems, but it}@@ @@latex:\protect\cmblue{systems. It}@@ is substantially more challenging to develop so-called /reactive/ potentials that can accurately model the underlying physics of systems where bonds are broken and formed. One approach is to develop potentials that @@latex:\protect\cmred{utilize}@@ @@latex:\protect\cmblue{use}@@ chemical bond-order dependent functional terms that are fit exclusively (or primarily) to QC datasets cite:liang-2013-react-poten. A challenge with these approaches is @@latex:\protect\cmred{the difficulty of}@@ knowing what data should be used for training and how to parameterize potentials that best fit the data.

In contrast, mathematical potentials are becoming more popular in chemical applications, and recent work has shown reasons for excitement.cite:behler-2011-neural,behler-2014-repres. Specifically, recent descriptive models from Behler and Parrinello cite:behler-2007-gener-neural have expanded the applications of neural networks to ``high-dimensional'' systems that can account for variable numbers of atoms, multiple compositions, and reactions involving thousands of atoms. Such networks have already been implemented on a large range of systems, including: Si bulk structures cite:behler-2008-press, water clusters cite:morawietz-2013-densit-funct, Cu surfaces cite:artrith-2012-high, ZnO cite:artrith-2011-high, and even a quaternary system of Cu/Au/H/O cite:artrith-2015-grand-cu. This opens the door for mathematical potentials to be developed that are accurate and transferable across diverse bulk, surface, and cluster regimes.

In this work, we compare the performance of a widely used physical potential, ReaxFF, with the recently developed Behler-Parrinello neural network (BPNN) potential. We have trained both to subsets of a full dataset comprised of $\approx$ 10,000 KS-DFT calculations. We chose Au for this study due to its diversity of known nanoscale structures. The fact that long-range electronic interactions are screened in Au makes it an appropriate system to model with atomistic physical and mathematical potentials that are less suited for long-range interactions such as ReaxFF and BPNN. (We note that long range effects can be incorporated into BPNN potentials, e.g. as has been done for ZnO cite:artrith-2011-high).

We have benchmarked both potentials to our QC dataset that contains information from KS-DFT bulk equation of state (EOS) data, vacancy formation energies, surface energies, adatom diffusion profiles, slipping barriers, and cluster binding energies. Parameterization of ReaxFF potentials were automated using the @@latex:\protect\cmred{Monte-Carlo}@@ @@latex:\protect\cmblue{Monte Carlo}@@ Force Field optimization (MCFFopt) tool in ADF cite:velde-2001-chemis-adf,iype-2013-param-monte. Our BPNN was parameterized using the Atomistic Machine-learning Potentials (AMP) code from the Peterson group at Brown University cite:peterson-amp. This allows feed-forward neural networks to be developed inside the atomic simulation environment (ASE) cite:atomic-simul-envir. All details of the trained BPNNs are stored in a JSON file which can be found in the supporting information (SI) file.

* Methods
** Density Functional Theory
KS-DFT calculations for training set data were performed using the Vienna /ab initio/ simulation package (VASP) cite:kresse-1993-ab,kresse-1994-ab,kresse-1996-effic,kresse-1996-effic2 with the Perdew-Burke-Ernzerhof generalized gradient approximation (GGA-PBE) cite:perdew-1996-gener-gradien,perdew-1997-gener-gradien exchange-correlation functional. Core electrons were described using the projector augmented wave function (PAW) cite:blochl-1994-projec-augmen,kresse-1999-from-ultras. /k/-points were represented using Monkhorst-Pack grids cite:monkhorst-1976-special-point with a density of at least 14 \times 14 \times 14 for a single atom of Au in the primitive ground state configuration. Kohn-Sham orbitals were expanded up to energy cutoffs of at least 300 eV to attain an energy convergence of at least 5 meV/atom. All calculations involving relaxations were completed with relaxation criteria of $< 0.05$ eV/\AA. Unless otherwise noted, transition states were determined using the climbing image nudged elastic band (NEB) method cite:henkelman-2000. The details for all the KS-DFT calculations are included in an ASE database that is embedded in the SI file. Instructions on how to access this database and reproduce these calculations can also be found in the SI along with more details on the methods used in this work.

The full KS-DFT training set contained @@latex:\protect\cmred{9972}@@ @@latex:\protect\cmblue{9,972}@@ calculations that included 905 bulk, @@latex:\protect\cmred{1022}@@ @@latex:\protect\cmblue{1,022}@@ surface, and @@latex:\protect\cmred{8045}@@ @@latex:\protect\cmblue{8,045}@@ cluster configurations. The majority of these calculations @@latex:\protect\cmred{(9076}@@ @@latex:\protect\cmblue{(9,076}@@ calculations) were taken from coordinate relaxation steps performed by VASP. @@latex:\protect\cmblue{These structures are the incremental steps taken from its initially guessed positions to the ground state configurations predicted by GGA-PBE. Each of the structures in a particular relaxation are very similar from one relaxation step to the next.}@@ The remaining 896 calculations @@latex:\protect\cmred{were taken from}@@ @@latex:\protect\cmblue{are}@@ either @@latex:\protect\cmblue{the}@@ local ground state configurations or images from optimized NEB calculations. Our bulk Au data were obtained by plotting EOS data for a variety of bulk structures. Vacancy formation and diffusion calculations were also included in the bulk dataset. Our surface dataset includes @@latex:\protect\cmred{data}@@ @@latex:\protect\cmblue{calculations}@@ on fcc(111) surfaces as well as a variety of fcc(100) surface diffusion pathways that were originally generated in previous work by P\ouml{}tting et. al. cite:potting-2010-self-diffus. The training set used single-point energies on the latter coordinates (without geometry relaxations) calculated using the methods listed above. Our cluster data include various 3D ordered, planar, and disordered structures that contain up to 126 atoms. The SI @@latex:\protect\cmblue{file}@@ has further details about the data.

** Reactive Force Field
Bond order based reactive force @@latex:\protect\cmred{fields}@@ @@latex:\protect\cmblue{fields,}@@ such as Tersoff cite:tersoff-1988-new, Brenner cite:brenner-1990-empir, and ReaxFF cite:nielson-2005-devel-reaxf,duin-2001-reaxf @@latex:\protect\cmred{potentials}@@ @@latex:\protect\cmblue{potentials,}@@ differ from classical force @@latex:\protect\cmred{fields}@@ @@latex:\protect\cmblue{fields,}@@ such as UFF cite:casewit-1992-applic,rappe-1992-uff, CHARMM cite:brooks-1983-charm, or AMBER cite:cornell-1995-secon-gener,cornell-1996-secon-gener, which require that defined bonds remain fixed over the course of a simulation. ReaxFF potentials developed for Au and other metals normally employ three separate energy terms as seen in Equation ref:eqn-base-reax. cite:jarvi-2008-devel-reaxf,keith-2010-react,cabrera-trujillo-2015-theor

\begin{eqnarray}
E_{total} = E_{bond} + E_{over} + E_{vdw} \label{eqn-base-reax}
\end{eqnarray}

$E_{bond}$ is for bond energies @@latex:\protect\cmred{to pairs}@@ of @@latex:\protect\cmred{atoms,}@@ @@latex:\protect\cmblue{atom pairs,}@@ $E_{over}$ is an energy penalty to prevent overcoordination, and $E_{vdw}$ accounts for van der Waals interactions and interatomic repulsions when interatomic distances are too small. ReaxFF potentials can also be parameterized to include 3-body terms which @@latex:\protect\cmred{provides}@@ @@latex:\protect\cmblue{provide}@@ energy contributions from valence angles between sets of three Au atoms. @@latex:\protect\cmred{Nordlund and coworkers}@@ @@latex:\protect\cmblue{Backman et. al.}@@ developed a Tersoff potential for Au that involves 3-body terms cite:backman-2012-bond, but these terms are not always added to ReaxFF potentials for metals @@latex:\protect\cmred{since they bring}@@ @@latex:\protect\cmblue{due to}@@ increased computational cost. Our 3-body terms have the same form as valence angle interactions in hydrocarbon ReaxFF potentials @@latex:\protect\cmred{cite:nielson-2005-devel-reaxf, and we discuss parameterization}@@ @@latex:\protect\cmblue{cite:nielson-2005-devel-reaxf. We report comparisons}@@ in @@latex:\protect\cmred{the SI file. The complete}@@ @@latex:\protect\cmblue{equations of state and timings for}@@ ReaxFF @@latex:\protect\cmred{parameters are also given}@@ @@latex:\protect\cmblue{using 3-body and 2-body terms}@@ in the SI file. @@latex:\protect\cmblue{Future work will discuss these topics in greater detail.}@@

We parameterized our Au ReaxFF using the MCFFopt tool implemented in ADF cite:velde-2001-chemis-adf,iype-2013-param-monte. MCFFopt seeks to minimize an objective function by randomly changing force field parameters within a predefined range. The Monte Carlo nature of this process allows some parameter changes that increase the objective @@latex:\protect\cmred{function to occur.}@@ @@latex:\protect\cmblue{function.}@@ This ``annealing'' allows the optimizer to sample a larger parameter space and potentially produce multiple distinct parameter sets. This approach @@latex:\protect\cmred{is}@@ @@latex:\protect\cmblue{can}@@ also @@latex:\protect\cmred{capable of finding}@@ @@latex:\protect\cmblue{find}@@ parameter sets with less total error than the traditional parabolic search parameter optimization cite:iype-2013-param-monte. Further information @@latex:\protect\cmred{how to run}@@ @@latex:\protect\cmblue{on running}@@ the MCFFopt procedure @@latex:\protect\cmred{is}@@ @@latex:\protect\cmblue{and optimized force field parameters are}@@ available in the SI file.

@@latex:\protect\cmblue{Au}@@ ReaxFF potentials @@latex:\protect\cmred{for Au}@@ appear to have an optimal training set size. Fitting to larger training sets @@latex:\protect\cmred{than the optimal size}@@ does not always improve the quality of the ReaxFF potential, and @@latex:\protect\cmred{unintentional biasing}@@ @@latex:\protect\cmblue{this overfitting is found to bias predictions}@@ toward certain geometry @@latex:\protect\cmred{types (i.e. overfitting) was observed.}@@ @@latex:\protect\cmblue{types.}@@ As a result, the ReaxFF training set was constructed using @@latex:\protect\cmred{only}@@ @@latex:\protect\cmblue{the 848}@@ ground state geometries from within the training set. @@latex:\protect\cmred{This amounted to 848 calculations that consisted}@@ @@latex:\protect\cmblue{Out}@@ of @@latex:\protect\cmred{approximately}@@ @@latex:\protect\cmblue{these geometries,}@@ the @@latex:\protect\cmred{same}@@ number of calculations classified as bulk, surface, and cluster @@latex:\protect\cmred{structures.}@@ @@latex:\protect\cmblue{structures are roughly equal.}@@ During ReaxFF @@latex:\protect\cmred{parameterization,}@@ @@latex:\protect\cmblue{parameterizations,}@@ each geometry @@latex:\protect\cmblue{in the training set}@@ is @@latex:\protect\cmblue{also}@@ assigned a weight depending on its relative @@latex:\protect\cmred{importance.}@@ @@latex:\protect\cmblue{importance in the overall fitting procedure.}@@ Our @@latex:\protect\cmred{choice}@@ @@latex:\protect\cmblue{goal was to produce a ReaxFF potential with reasonable accuracy across these three different structure regimes, so most of the geometries were given a weight}@@ of @@latex:\protect\cmred{weights}@@ @@latex:\protect\cmblue{one (specific details}@@ are @@latex:\protect\cmred{explained}@@ @@latex:\protect\cmblue{given}@@ in the SI @@latex:\protect\cmred{file.}@@ @@latex:\protect\cmblue{file). In principle, one could increase weights to parts of the PES so that properties, such as desired lattice constants, bulk moduli, or barrier heights would be accurately reproduced. However, weighting a potential in this way will affect its ability to make accurate predictions in less-weighted regions of the PES.}@@

Figure ref:fig-reax-train shows the error distribution @@latex:\protect\cmblue{of residual error}@@ between @@latex:\protect\cmred{our}@@ @@latex:\protect\cmblue{the}@@ trained ReaxFF and KS-DFT training set data labeled by geometry type. Errors in bulk data greater than 0.2 eV stem from an unphysical convex region in the ReaxFF functional form which causes bulk EOS data to significantly deviate from the KS-DFT data at atomic volumes ranging from 60-200 \AA^{3}/atom. Since these atomic volumes fall outside those found in most simulations involving bulk and surface structures of Au, @@latex:\protect\cmred{they}@@ @@latex:\protect\cmblue{these inaccuracies}@@ are not @@latex:\protect\cmred{considered to be}@@ a cause for @@latex:\protect\cmred{concern for most applications.}@@ @@latex:\protect\cmblue{significant concern.}@@ However, large errors in bond energies for pairs of atoms at intermediate distances may be problematic for molecular clusters. @@latex:\protect\cmblue{Images of the entire EOS for each bulk structure can be found in the SI.}@@

#+label: fig-reax-train
#+caption: Energy residual error to the training set data broken down by bulk, surface, and cluster geometries for the ReaxFF potential.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-reax-train.png]]

A predefined validation set consisting of 238 @@latex:\protect\cmblue{calculations (out}@@ of the @@latex:\protect\cmred{9972}@@ @@latex:\protect\cmblue{total 9,972}@@ KS-DFT @@latex:\protect\cmred{calculations}@@ @@latex:\protect\cmblue{calculations)}@@ was set aside to test the transferability of predictions from our ReaxFF and BPNN potentials. @@latex:\protect\cmblue{This validation set was chosen to represent a variety of different Au structure types which are represented in the results section of this work.}@@ By reporting probability distributions for both the training and validation sets, we can determine the degree that our potentials show selection bias. For an ideal fitting procedure, the probability distributions for both the training and validation set would match, and any differences between the two would signify an over- or under-sampling. Figure ref:fig-reax-valid shows the residual error for the validation calculations labeled by geometry type. Significant deviations were found in bulk and cluster calculations @@latex:\protect\cmred{of}@@ @@latex:\protect\cmblue{from}@@ the validation @@latex:\protect\cmred{set, as was observed with the}@@ @@latex:\protect\cmblue{and}@@ training set data.

#+label: fig-reax-valid
#+caption: Energy residual error to validation set data broken down by bulk, surface, and clusters for the ReaxFF potential.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-reax-valid.png]]

** Neural Network
The NN is a machine learning algorithm. Unlike @@latex:\protect\cmred{ReaxFF potentials,}@@ @@latex:\protect\cmblue{ReaxFF,}@@ potentials constructed from @@latex:\protect\cmblue{the}@@ NN have no physical basis, making them highly flexible, but also unsuitable for extrapolation. Nevertheless, NN potentials are growing in popularity due to their abilities to accurately characterize a PES from QC calculations. BPNN potentials were selected for this study @@latex:\protect\cmred{due to their capacity to}@@ @@latex:\protect\cmblue{because they can}@@ be trained to @@latex:\protect\cmred{larger systems of interest}@@ @@latex:\protect\cmblue{relatively large training sets}@@ cite:behler-2007-gener-neural. BPNN potential fitting is facilitated through symmetry functions and utilization of multiple feed-forward NNs, one for each chemical species in the system. These modifications eliminate many of the shortcoming of traditional Cartesian NN potentials that are only applicable to systems with a fixed number of atoms.

Unlike other mathematical potentials, BPNN potentials cite:behler-2011-atom,behler-2007-gener-neural utilize a cutoff radius, $R$, that is applied to each atom in each image in the training set to keep the cost of the symmetry function small. Thus, the goal is to find a value of $R$ that is large enough to capture meaningful atomic interactions but one that is not too large to result in high computational costs. These standard BPNN potentials are not suited for systems of atoms that have long-range interactions that extend outside the cutoff radii. For Au, we used $R$ = 6.5 \AA as long-range interactions are assumed to be negligible. (We find $\approx$ 2 meV/nearest-neighbor energy differences between gas phase Au and a primitive fcc unit cell with 6.5 \AA nearest-neighbor distance). In the absence of this cutoff radius, it has been proven that NNs are capable of arbitrary levels of accuracy cite:hornik-1989-multil.

The general structure of a feed-forward NN @@latex:\protect\cmred{potential}@@ consists of nodes in an input layer, one or more hidden layers, and an output layer. In our BPNN @@latex:\protect\cmred{potentials,}@@ @@latex:\protect\cmblue{potential,}@@ the nodes of the input layer are the Cartesian-coordinates of each atom in the unit cell. Each hidden layer is a linear combination of the values of the nodes from the previous @@latex:\protect\cmred{layers.}@@ @@latex:\protect\cmblue{layer.}@@ Each layer is also multiplied by an activation function (which often has a bounded non-linear form) to allow the NN potential to fit to arbitrary functions. The most accurate BPNN potential that we @@latex:\protect\cmred{produced}@@ @@latex:\protect\cmblue{produced,}@@ and report in this @@latex:\protect\cmred{work}@@ @@latex:\protect\cmblue{work,}@@ utilizes four hidden layers with 40 nodes per layer and a hyperbolic tangent activation function. These specifications make our BPNN potential @@latex:\protect\cmred{comparatively larger than}@@ @@latex:\protect\cmblue{large compared to}@@ other BPNN potentials and more at risk for overfitting. However, @@latex:\protect\cmred{since}@@ the root-mean square error (RMSE) of the validation set is similar to that of the training set, @@latex:\protect\cmblue{showing that}@@ overfitting has not occurred cite:behler-2015-const. For further details on the theory behind BPNNs, we refer to previous work cite:behler-2007-gener-neural,behler-2011-atom.

We trained BPNN potentials using AMP, a code produced by the Peterson group at Brown University cite:peterson-amp. This software conveniently interfaces with the Atomic Simulation Environment (ASE) software package cite:atomic-simul-envir for ease @@latex:\protect\cmred{in}@@ @@latex:\protect\cmblue{of}@@ reusability and @@latex:\protect\cmred{reproducibility of work.}@@ @@latex:\protect\cmblue{reproducibility.}@@ The trained calculator @@latex:\protect\cmred{parameter}@@ @@latex:\protect\cmblue{parameters}@@ used by AMP @@latex:\protect\cmred{as well as variables needed to reproduce the BPNN potential (i.e. symmetry functions, cutoff radius, and hidden layers and nodes)}@@ are included in the SI file.

Of the @@latex:\protect\cmred{9974}@@ @@latex:\protect\cmblue{9,972}@@ total calculations, @@latex:\protect\cmred{9734}@@ @@latex:\protect\cmblue{9,734}@@ were used for training the BPNN potential. Figure ref:fig-neural-train shows the error distribution from the training set. The mean, $\mu$, and standard deviation, $\sigma$ are given assuming a normal distribution fit. The RMSE is 0.017, similar to the standard deviation, indicating that the data is well approximated by a normal distribution overall.

#+label: fig-neural-train
#+caption: Energy residual error to the training dataset of the BPNN calculations. A RMSE of 0.017 eV/atom is calculated for the @@latex:\protect\cmred{9734}@@ @@latex:\protect\cmblue{9,734}@@ structures included in the training set. The training set is also well described by a normal distribution.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-neural-train.png]]

Figure ref:fig-neural-valid shows the error distribution for the validation dataset. Overfitting can be identified by a divergence between the RMSE of the training set and validation set data. In this case, the distribution is clearly not normal and arises from some underrepresented data in the training set, notably the fcc(100) terrace and dimer diffusion pathways (discussed below).

#+label: fig-neural-valid
#+caption: Energy residual error to the validation dataset of BPNN calculations. $\sigma$ = 0.21, similar to the training set RMSE indicating little to no overfitting has occurred. The cluster of overpredicted surface calculations are from fcc(100) surface diffusion pathways, which are poorly represented in the training set.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-neural-valid.png]]

* Results and Discussion
We now benchmark the performance of the BPNN and ReaxFF potentials against KS-DFT energies across three different material regimes: bulk, surface, and molecular cluster structures. @@latex:\protect\cmred{Overall, we show that both}@@ @@latex:\protect\cmblue{Both of our generated}@@ potentials can provide reasonably accurate descriptions of Au in the different material regimes. In general we find that ReaxFF potentials are more readily overfit, less transferrable to applications involving clusters of 126 atoms or fewer, and overall less accurate than the BPNN. However, ReaxFF potentials @@latex:\protect\cmred{have}@@ @@latex:\protect\cmblue{demonstrate}@@ a notable strength @@latex:\protect\cmred{in}@@ @@latex:\protect\cmblue{by}@@ predicting barrier heights that resemble those found in their training @@latex:\protect\cmred{sets with less training data.}@@ @@latex:\protect\cmblue{sets.}@@ BPNN potentials in general are significantly more accurate than ReaxFF potentials, but they require significantly larger training sets to ensure well-balanced fitting. As explained below, they also currently bring substantially higher computational cost than ReaxFF potentials.

** Bulk properties
*** Equations of state
EOS data for face centered cubic, simple cubic, and diamond structures are shown in Figure ref:fig-bulk-eos. All training and validation calculations are fit to a 3rd order inverse polynomial cite:alchagirov-2003-reply-commen. The metrics for each fit are included in Table ref:tbl-eos. Results for the body centered cubic and hexagonal close packed EOS data are similar to the face centered cubic curve. Fits to all curves can be found in the SI file.

#+label: fig-bulk-eos
#+caption: Comparison of EOS fits to KS-DFT, ReaxFF, and BPNN training and validation set data. Fits only include data within atomic volumes of \pm 15 \AA/atom as this is the region of interest for most applications.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-bulk-eos.png]]

Figure ref:fig-bulk-eos shows that the EOSs are very well represented by our BPNN potential. Validation set data are also well behaved, indicating that overfitting has not occurred. Metric data shown in Table ref:tbl-eos shows excellent agreement in the minimum volume, minimum energy, and bulk modulus found using KS-DFT results. Data for the hcp and bcc structures shown in the SI file are reproduced similarly well.

We find that ReaxFF potentials @@latex:\protect\cmred{including}@@ @@latex:\protect\cmblue{with}@@ 3-body terms have substantially better fits compared to force fields which do not include 3-body interactions (see cite:keith-2010-react). However, in both cases ReaxFF exhibits an unphysical convexity of the bond energy curve that creates problems manifested by large residual errors that can reach as high as \pm 1 eV/atom at volumes @@latex:\protect\cmred{larger than}@@ @@latex:\protect\cmblue{away from}@@ the minimum energy volume. Many simulations sample regions in the vicinity surrounding the minimum volume, so these deviations are not shown in Figure ref:fig-bulk-eos. Data from Table ref:tbl-eos shows reasonably good agreement for the equilibrium volume and minimum energy @@latex:\protect\cmred{for}@@ @@latex:\protect\cmblue{of}@@ the three @@latex:\protect\cmred{structures, but bulk}@@ @@latex:\protect\cmblue{structures. Bulk}@@ moduli are @@latex:\protect\cmred{substantially}@@ underpredicted by $\approx$ 20 GPa for each structure due to differences in the curvature of the EOS at the minimum. @@latex:\protect\cmblue{Again, one would likely improve the quality of predictions for individual properties by reweighting the parameterization to favor specific properties (e.g. bulk moduli), but this preferential fitting would also be expected to lower the quality of other predicted properties.}@@

#+RESULTS:
#+caption: Comparison of EOS metrics for KS-DFT, ReaxFF, and BPNN fits as shown in Figure ref:fig-bulk-eos.
#+attr_latex: :placement [H]
#+tblname: tbl-eos
| Structure   | Minimum volume (\AA^{3}) | Minimum energy (eV) | Bulk Mod. (GPa) |
|-------------+--------------------------+---------------------+-----------------|
| KS-DFT-fcc  |                    17.97 |               -3.23 |             147 |
| BPNN-fcc    |                    17.99 |               -3.23 |             145 |
| ReaxFF-fcc  |                    17.60 |               -3.22 |             122 |
|-------------+--------------------------+---------------------+-----------------|
| KS-DFT-sc   |                    20.73 |               -3.02 |             110 |
| BPNN-sc     |                    20.66 |               -3.02 |             110 |
| ReaxFF-sc   |                    21.29 |               -2.96 |              84 |
|-------------+--------------------------+---------------------+-----------------|
| KS-DFT-diam |                    29.04 |               -2.51 |              56 |
| BPNN-diam   |                    28.98 |               -2.51 |              57 |
| ReaxFF-diam |                    31.92 |               -2.54 |              37 |
|-------------+--------------------------+---------------------+-----------------|

*** Bulk vacancy formation and diffusion barrier
Vacancy formation energies ($E_v$) are calculated using Equation ref:eqn-vac. $E_f$, $n_0$, and $E_i$ are the energies of the structure with vacancy, number of atoms in the structure before forming the vacancy, and energy of the structure before forming the vacancy, respectively. Our KS-DFT vacancy formation energies, shown in Figure ref:fig-vacancy-formation, are in good agreement with other GGA-PBE calculations (0.42 eV), but both sets of data significantly underpredict experimental results (0.93 eV) cite:xing-2014-vacan. This is likely due to the well-known shortcoming of GGA-PBE in underpredicting atomization energies of Au cite:schimka-2013-lattic. In this work, vacancy formation is referenced to the energy of a single atom in a primitive fcc unit cell. This may explain why the formation energies calculated here are slightly lower than those in the literature. The vacancies seem to reach the dilute concentration limit at $\approx$ 0.037 vacancies/atom. The anomalous increase in energy for the structure at $\approx$ 0.015 vacancies/atom is due to a minor structural perturbation into a different local minimum. More information about the nature of the reconfiguration can be found in the SI file.

\begin{eqnarray}
E_v = E_f - \frac{n_0 - 1}{n_0} E_i \label{eqn-vac}
\end{eqnarray}

Our BPNN @@latex:\protect\cmred{predictions of}@@ vacancy @@latex:\protect\cmred{formations}@@ @@latex:\protect\cmblue{formation predictions}@@ are systematically overestimated by $\approx$ 0.4 @@latex:\protect\cmred{eV,}@@ @@latex:\protect\cmblue{eV}@@ while ReaxFF @@latex:\protect\cmred{predictions of}@@ vacancy @@latex:\protect\cmred{formations}@@ @@latex:\protect\cmblue{formation predictions}@@ are systematically underestimated by $\approx$ 0.3 eV. The preservation in trends indicates some error cancellation from the reference state for both fits. We find that neither method is sensitive enough to predict the subtle increase in energy for @@latex:\protect\cmblue{the}@@ reconfigured @@latex:\protect\cmred{structures.}@@ @@latex:\protect\cmblue{structure.}@@ Although the BPNN potential results are closer to experiment than @@latex:\protect\cmred{ReaxFF,}@@ @@latex:\protect\cmblue{the ReaxFF potential,}@@ this is simply a fortuitous error. @@latex:\protect\cmred{Since}@@  BPNN potentials have no physical @@latex:\protect\cmred{basis, the BPNN should simply}@@ @@latex:\protect\cmblue{basis and therefore would}@@ reproduce the KS-DFT @@latex:\protect\cmred{exactly.}@@ @@latex:\protect\cmblue{exactly with complete training.}@@

The residual errors for structures with concentrations below 0.04 vacancies/atom are very low (less than 0.006 eV/atom, even for the point in the validation set having $\approx$ 0.037 vacancies/atom). Error cancellation between the vacancy structures and reference structure make it difficult to determine the level of @@latex:\protect\cmred{accuracy}@@ @@latex:\protect\cmblue{precision}@@ needed to obtain @@latex:\protect\cmred{consistently}@@ accurate @@latex:\protect\cmred{fits.}@@ @@latex:\protect\cmblue{vacancy formation energies.}@@ A BPNN potential for Cu has been constructed with a higher level of accuracy (error $< 0.11$ eV), at the increased cost of a basis of calculations which is $\approx$ 3.5 times larger cite:artrith-2012-high. BPNN calculations were also performed using unit cells of the same size as the corresponding vacancy structure. The same trend was observed with slightly higher formation energies using the expanded reference super cell.

#+label: fig-vacancy-formation
#+caption: Bulk vacancy formation energies for fcc Au at various concentrations. BPNN fits to vacancy structures are systematically overpredicted by $\approx$ 0.4 eV, while ReaxFF fits are systematically underpredicted by $\approx$ 0.3 eV. Literature values are from Ref. citenum:xing-2014-vacan.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-vacancy-formation.png]]

Figure ref:fig-vacancy-diffusion shows the calculated bulk vacancy diffusion barrier using a vacancy concentration of $\approx$ 0.037 vacancies/atom (obtained from Figure ref:fig-vacancy-formation). NEB calculations determined points along the minimum energy pathway that were then fit to a cubic spline. For diffusion calculations, the residual errors of both the BPNN and ReaxFF potentials are lower by about an order of magnitude as compared to the vacancy formation energy. This is due to error cancellation from the reference states that are similar to states along each reaction pathway. The BPNN potential overestimates this barrier by 0.04 eV while the ReaxFF potential underestimates the barrier by 0.05 eV.

#+label: fig-vacancy-diffusion
#+caption: NEB predicted barrier for bulk vacancy diffusion through fcc Au. Transitions state energy (black, 0.56 eV) is overpredicted by the BPNN (red, 0.60 eV) and underpredicted by the ReaxFF (blue, 0.50).
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-vacancy-diffusion.png]]

** Surface calculations
*** fcc(100) diffusion barriers
The training set for the ReaxFF potential in Reference citenum:keith-2010-react contains 166 surface diffusion barrier calculations @@latex:\protect\cmred{using}@@ @@latex:\protect\cmblue{from}@@ GGA-PBE @@latex:\protect\cmred{calculations obtained}@@ using the SEQQUEST code cite:schultz-2002-seqques. NEB calculations with VASP were not used to recalculate the minimum energy pathways, but we recalculated single point energies on these structures using GGA-PBE in VASP to be consistent with the rest of our training set. Since NEB calculations were not done, there are significantly fewer points sampling the PES for these pathways compared to other pathways (8-10\times fewer in most cases). Consequently, our BPNN fits to these pathways are expected to be less accurate compared to other pathways obtained from NEB calculations.

Figure ref:fig-full-diffusion @@latex:\protect\cmred{are}@@ @@latex:\protect\cmblue{contains}@@ recreations from Figure 2 (a \& b) in Ref. citenum:keith-2010-react using the BPNN potential and ReaxFF potential. Note that the terrace and dimer diffusion pathways are not included in the training set for either potential, and they represent predictions by both potentials. For the terrace diffusion pathway, the ReaxFF potential performs quite well and shows that @@latex:\protect\cmblue{the}@@ ReaxFF @@latex:\protect\cmblue{potential}@@ can provide very accurate predictions of barrier heights when the training set contains @@latex:\protect\cmred{enough sufficiently}@@ similar pathways. The BPNN potential, which @@latex:\protect\cmred{overall}@@ contains more than 10\times the training set data as the ReaxFF potential, can reasonably produce this adatom diffusion barrier but residuals @@latex:\protect\cmred{can}@@ fall between 0.2-0.3 eV. On the other hand, for a different adatom diffusion barrier, the BPNN potential predicts the dimer diffusion pathway quite well while the ReaxFF potential has higher residual errors between 0.1-0.2 eV. Larger training sets can be expected to reduce errors in both potentials, but reparameterization of these potentials with a larger training set will undoubtedly impact the accuracy when predicting other pathways.

#+label: fig-full-diffusion
#+caption: Residuals to diffusion pathways in the validation set. Structures are reproduced from those used in Ref. citenum:keith-2010-react.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-full-diffusion.png]]

To assess the performance of these potentials under a wide range of adatom diffusions, Figure ref:fig-barrier-residuals shows the residuals for all 144 fcc(100) surface diffusion calculations. Solid shapes represent training set data and hollow shapes represent validation set data. Residuals are the same as those shown in Figure ref:fig-full-diffusion. Our ReaxFF potential (which has roughly 1/3 of its training set devoted to surface calculations) has 86.1% of these structures falling within a \pm 0.1 eV tolerance of error. For the BPNN potential (with roughly 1/10 of its training set devoted to @@latex:\protect\cmblue{surface}@@ calculations), has 52.1% of these structures fall within a \pm 0.1 eV tolerance of error.

Many of the calculations from the BPNN potential are underestimated compared to the reference KS-DFT data, signifying (as stated above) that these structures come from a poorly sampled region of the PES and improvements @@latex:\protect\cmred{would likely}@@ @@latex:\protect\cmblue{could}@@ be attained with more training. For the ReaxFF potential, errors appear to be less systematic, showing improved accuracy would require more training to specific pathways. In practice, both ReaxFF and BPNN potentials are normally trained with a specific application in mind, and so training sets, particularly those for ReaxFF @@latex:\protect\cmred{potentials}@@ @@latex:\protect\cmblue{potentials,}@@ can be smaller.

#+label: fig-barrier-residuals
#+caption: Residuals of 144 fcc(100) surface diffusion pathway calculations included from Ref. citenum:keith-2010-react. Hollow markers represent residuals from the validation set which are shown in Figure ref:fig-full-diffusion.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-barrier-residuals.png]]

*** fcc(111) surface slipping barrier
A slipping barrier is the minimum energy pathway required for a certain number of mono-layers of atoms to move from their ground state site to the next most adjacent site of the same kind. Slipping barriers were performed on fcc(100) and fcc(111) surfaces for one and two layers in a five layer slab. Figure ref:fig-111-slipping shows the single-layer slipping barrier for the fcc(111) surface. Both models find almost identical energies as KS-DFT (within 0.05 eV). We can see that the ReaxFF potential finds a metastable intermediate instead of a single barrier as found by KS-DFT and the BPNN potential. This ReaxFF potential also finds metastable intermediates when slipping in a different direction primarily over bridge sites (see the SI file), but residual errors are even lower. The very small difference in energies makes it difficult to assess if these are due to fitting errors or an unphysical component within the ReaxFF potential. Either way, both potentials can reproduce low energy slipping barriers within 0.05 eV with sufficient training.

#+label: fig-111-slipping
#+caption: NEB predicted slipping barrier for a single layer of fcc(111). Initial, bridge, and top positions are shown for visual reference. The second local minima is representative of the hcp site. The darkest gray represents the deepest layer, while the lightest shade is the top layer.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-111-slipping.png]]
** Cluster predictions
*** 6 atom clusters
Calculations on clusters up to 126 atoms make up $\approx$ 81% of the entire database. To determine the robustness of the BPNN potential for determining the energetics of structures not incorporated into the training set, several BO-MD simulations were performed on various clusters. For a six atom cluster, calculations were performed with NVT BO-MD without planar boundary conditions, where the temperature of the system was changed from 800 K to 300 K over the course of the simulation. The simulation using the BPNN potential started from a local minimum structure to determine if @@latex:\protect\cmred{the BPNN potential}@@ @@latex:\protect\cmblue{it}@@ would locate the known global minimum energy configuration. @@latex:\protect\cmred{Our KS-DFT approach}@@ @@LATEX:\PROTECT\CMBLUE{GGA-PBE}@@ found the global minimum to be planar and triangular (see Figure ref:fig-6atom-md), which is also observed in the literature cite:phaisangittisakul-2012-stabl. This structure was not included in the training set.

Figure ref:fig-6atom-md depicts the path taken by the BPNN BO-MD simulation (red) over the course of @@latex:\protect\cmred{2000}@@ @@latex:\protect\cmblue{2,000}@@ time steps. Once every 100 steps we validated the energy using KS-DFT. The residuals are less than 0.05 eV/atoms @@latex:\protect\cmred{error}@@ for the BPNN potential, including the structure of the global minimum. We re-ran this simulation several times throughout development of the database. The first attempt at performing the described BO-MD simulation was with a dataset of $\approx$ @@latex:\protect\cmred{2000}@@ @@latex:\protect\cmblue{2,000}@@ cluster calculations with 20 atoms or fewer. In comparison with the full dataset, the residual error has been reduced dramatically, and the success rate of discovering the global minimum improved significantly. Further details of these initial attempts with the smaller database can be found in the SI file.

The @@latex:\protect\cmred{2000}@@ @@latex:\protect\cmblue{2,000}@@ structures generated from the BO-MD run with our BPNN potential were then calculated using the ReaxFF potential. In this case, the ReaxFF potential did not identify the same @@latex:\protect\cmred{the}@@ minimum energy configuration of the six atom @@latex:\protect\cmred{system, but}@@ @@latex:\protect\cmblue{system. However,}@@ the cohesive energies of structures resembling the planar cluster are fairly consistent with KS-DFT data. @@latex:\protect\cmblue{Although the presented data shows situations where ReaxFF is not accurate, we note that this may signify an area where ReaxFF could be extended with additional functionality. For example, metal-metal bonds in small clusters could be treated with functional forms different than those used for bulk metal-metal bonds. This would likely correct systematic deviations, but such re-parameterizations may also adversely affect other structure types and/or increase computational cost. We note that Narayanan et. al. have reported a hybrid bond order potential that uses a screened Lennard-Jones term for bulk structures in combination with a highly trained Tersoff potential for smaller regimes cite:badri-2015-descr. This is a possible work-around to make other physical potentials accurate across different size regimes.}@@

#+label: fig-6atom-md
#+caption: NVT BO-MD simulation of 6 atom cluster starting from local energy minimum and finding the global minimum. The temperature was reduced from 800 K to 300 K over the course of the simulation. Solid lines show BO-MD trajectories while dashed lines show energy predictions for the global minima from KS-DFT (black) and BPNN (red) and ReaxFF (blue).
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-6atom-md.png]]

*** 38 atom clusters
A similar exploration for multiple local minima was implemented on a 38 atom cluster using minima hopping techniques cite:goedecker-2004-minim. This exploration of minimum energy structures works through a series of fixed temperature NVT BO-MD simulations followed by geometric optimization requiring a significant number of calculations between each iteration. After each iteration, the minimum geometry is stored and perturbed before restarting its search. The resulting minima predicted from 125 such iterations are shown in Figure ref:fig-38atom-minima.

Again, this approach located a lower energy minimum than the starting point geometry. The largest energy difference between minima occurred during the first iteration of the process. After this initial step, the @@latex:\protect\cmred{energy KS-DFT and potential}@@ energies do not change as dramatically. This can be interpreted as a shift into a local minimum energy basin (a group of configurations with similar atomic positions and energies) which the BPNN potential proceeds to explore in the next 124 minima. A more complete analysis of the 38 atom Au cluster space would be time consuming and is beyond the scope of this work. Despite demonstrating low residual errors, the BPNN potential does not correctly predict the lowest energy structure determined by KS-DFT in this set of minima. Regardless, it is still capable of distinguishing between configurations in different basins, and thus could be a valuable tool for exploring minimum energy structures in conjunction with KS-DFT calculations.

Residual errors for the ReaxFF potential are consistently lower by -0.11 eV/atom compared to KS-DFT. If energetics are shifted by this amount (as show in the top of Figure ref:fig-38atom-minima) one finds that @@latex:\protect\cmblue{the}@@ trend in relative energies is in reasonable agreement with @@latex:\protect\cmred{the BPNN potential and}@@ KS-DFT, although our ReaxFF potential does not correctly predict the lowest energy configuration either. @@latex:\protect\cmred{We note that the}@@ @@latex:\protect\cmblue{The}@@ performance of the ReaxFF potential for clusters @@latex:\protect\cmred{might}@@ @@latex:\protect\cmblue{could always}@@ be improved by adding more cluster data to its training @@latex:\protect\cmred{set. However,}@@ @@latex:\protect\cmblue{set, but}@@ we found that doing so rapidly deteriorates its ability to calculate bulk and surface properties. As a result, we do not recommend using ReaxFF in its standard formalism for applications involving clusters with @@latex:\protect\cmblue{fewer than}@@ 126 @@latex:\protect\cmred{atoms or fewer. We note that Sankaranarayanan and co-workers have reported a hybrid bond order potential that uses a screened Lennard-Jones term for bulk structures in combination with a highly trained Tersoff potential for smaller regimes cite:badri-2015-descr, and this is a possible work-around to make other physical potentials accurate across different size regimes.}@@ @@latex:\protect\cmblue{atoms.}@@

#+label: fig-38atom-minima
#+caption: Local minima for 38 atom Au cluster predicted from the BPNN (red) and compared with KS-DFT (black) and ReaxFF (blue). The ReaxFF potential energies are offset by +0.11 eV/atom in the top figure to better depict the trend in energies.
#+attr_latex: :width 6in :placement [H]
#+attr_org: :width 600
[[./images/fig-38atom-minima.png]]

** Computational cost
An important aspect of these modeling approaches @@latex:\protect\cmblue{is}@@ their computational cost. This includes the time needed to produce the necessary @@latex:\protect\cmred{quantum chemistry}@@ @@LATEX:\PROTECT\CMBLUE{QC}@@ training @@latex:\protect\cmred{sets and implementing}@@ @@latex:\protect\cmblue{sets, train}@@ the @@latex:\protect\cmred{potentials themselves in addition to}@@ @@latex:\protect\cmblue{potentials, and}@@ the time needed to run the calculations. Implementation and training of parameters for both @@latex:\protect\cmblue{the}@@ ReaxFF and BPNN potentials can be automated using instructions in our SI file, thus reducing the time needed to learn how to train potentials. The generation of meaningful @@latex:\protect\cmred{quantum chemistry}@@ @@LATEX:\PROTECT\CMBLUE{QC}@@ data is also a significant bottleneck in time, particularly for BPNN potentials that require large training sets to be accurate. This is simplified in part by generating NEB data and geometry optimizations which contain many valuable calculations on which physical and mathematical potentials can be trained. One of the best ways to speed the progress of developing accurate and transferrable potentials is to make data and methods freely available and easily accessible.

A fair comparison between calculation times between ReaxFF and BPNN potentials is not currently possible. The BPNN potential we developed used a Python code that is still in early stages of development cite:peterson-amp. In comparison, ReaxFFs and other force field codes have been implemented in the LAMMPS program which is already a high performance computing code. cite:plimpton-1995-fast-paral. Using available open source tools, BO-MD simulations on the 6 atom cluster using the C-compiled ReaxFF code performs $\approx$ @@latex:\protect\cmred{6700}@@ @@latex:\protect\cmblue{6,700}@@ timesteps/second, while the Python BPNN in ASE performs $\approx$ 15 timesteps/second. Nevertheless, we consider BPNN potentials to be extremely promising for simulations requiring high accuracy, especially if they can be implemented into high performance codes that can dramatically accelerate their calculation times.

* Conclusions
We have trained ReaxFF and BPNN potentials using subsets of $\approx$ 10,000 KS-DFT calculations. Our training sets consider Au in a variety of atomic configurations in bulk, surface, and cluster regimes that would be useful for practical atomistic modeling across all regimes. By virtue of being a mathematical potential, the BPNN potential can be trained to an arbitrary level of accuracy. Our most accurate BPNN potential was fitted to 9,734 calculations and @@latex:\protect\cmred{yielded}@@ @@latex:\protect\cmblue{yields}@@ an RMSE of 0.017 eV. Our ReaxFF potential (which contains 3-bond terms for higher accuracy) was fitted best to a significantly smaller training set consisting of 848 calculations (a value that is considerably larger than parameter sets in many other ReaxFF potentials). This potential provides an overall RMSE of 0.136 eV compared to the full KS-DFT dataset.

In applications on bulk structures, our BPNN almost exactly reproduces reference @@latex:\protect\cmred{quantum chemistry}@@ @@LATEX:\PROTECT\CMBLUE{QC}@@ data of equations of state, while the ReaxFF potential is less accurate, particularly at atomic volumes that extend far beyond the equilibrium structures. When modeling surface structures and adatom diffusions, both the ReaxFF and BPNN potentials perform quite well with sufficient training, but obtaining a BPNN potential having comparable or higher accuracy than ReaxFF for adatom diffusions requires substantially larger training sets. For clusters, the BPNN potential exhibits essentially negligible residual errors compared to @@latex:\protect\cmblue{the}@@ KS-DFT calculations it was trained to, while the ReaxFF potential exhibits sizable systematic errors of 0.11 @@latex:\protect\cmred{eV, highlighting}@@ @@latex:\protect\cmblue{eV. This highlights}@@ the challenge of developing a physical potential that is accurate across bulk, surface, and cluster data. Increasing the size of the training set for the ReaxFF potential to include more cluster data was found to be detrimental to the accuracy of bulk and surface @@latex:\protect\cmred{data.}@@ @@latex:\protect\cmblue{data, thus showing an area needing improvement in terms of ReaxFF functionality.}@@

Although BPNNs can be trained to the desired level of accuracy, the computational cost, both upfront in the form of training set data and during calculation time, are currently substantially higher than ReaxFF potentials. Nevertheless, BPNN potentials are very promising if trained for specific applications (hence requiring smaller training sets) and they will be highly intriguing as computational developments enable faster runtimes. Since accurate BPNN potentials contain substantially larger numbers of parameters than most physical potentials, it is unlikely that BPNN potentials will ever be as @@latex:\protect\cmred{fast,}@@ @@latex:\protect\cmblue{fast as ReaxFF potentials,}@@ but we have demonstrated that BPNN potentials can be trained to be substantially more accurate.

* Acknowledgements
JRK and JRB gratefully acknowledge support from the National Science Foundation under grant number CBET-1506770. JAK and MCG gratefully acknowledge financial support from the R.K. Mellon Foundation and the University of Pittsburgh’s Department of Chemical & Petroleum Engineering.  They also thank the University of Pittsburgh Center for Simulation and Modeling for computational support.

bibliography:./manuscript.bib


* Build								   :noexport:


@@latex:\protect\cmblue{This generates the revisions between the current and submitted manuscript.
#+BEGIN_SRC emacs-lisp
(cm-wdiff-to-pdf '("HEAD" "submitted"))
#+END_SRC

#+RESULTS:
: t}@@


#+BEGIN_SRC emacs-lisp
(ox-manuscript-build-submission-manuscript)

(ox-manuscript-make-submission-archive nil nil nil nil nil
"images/toc.png" @@latex:\protect\cmblue{"manuscript-toc.tex" "manuscript-revised.pdf"}@@ "supporting-information.pdf")

@@latex:\protect\cmred{(loop for png in (f-entries "manuscript-2015-12-21" (lambda (f) (f-ext? f "png")))
      do
      (shell-command (format
		      "convert %s %s"
		      png
		      (replace-regexp-in-string "\.png$" ".eps" png))))}@@
#+END_SRC

#+RESULTS:
@@latex:\protect\cmblue{: manuscript-2016-01-24/}@@
